
<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from glitchcity.wiki/index.php?title=0x1500_control_code_arbitrary_code_execution&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 Oct 2020 08:04:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>0x1500 control code arbitrary code execution - Glitch City Wiki</title>
<script src="cdn-cgi/apps/head/TVJhTom-oMvagx6X31REykU34Zo.js"></script><script>document.documentElement.className="client-js";RLCONF={"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"0x1500_control_code_arbitrary_code_execution","wgTitle":"0x1500 control code arbitrary code execution","wgCurRevisionId":5374,"wgRevisionId":5374,"wgArticleId":5374,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Incomplete","Pages with an accompanying YouTube video","Arbitrary code execution"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"0x1500_control_code_arbitrary_code_execution",
"wgRelevantArticleId":5374,"wgRequestId":"7b81f32e615ff7a50f40aab5","wgCSPNonce":!1,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.toc.styles":"ready","mediawiki.skinning.interface":"ready","mediawiki.skinning.content.externallinks":"ready","skins.monobook.responsive":"ready"};RLPAGEMODULES=["site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.monobook.mobile"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.tokens@tffin",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="loadd167.css?lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.toc.styles%7Cskins.monobook.responsive&amp;only=styles&amp;printable=1&amp;skin=monobook" />
<script async="" src="loadcfba.php?lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;raw=1&amp;skin=monobook"></script>
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="load2f35.css?lang=en&amp;modules=site.styles&amp;only=styles&amp;printable=1&amp;skin=monobook" />
<meta name="generator" content="MediaWiki 1.34.2" />
<meta name="robots" content="noindex,follow" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0" />
<link rel="shortcut icon" href="Favicon.html" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Glitch City Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api-result251f.xml?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Glitch City Wiki Atom feed" href="feeda295.xml?title=Special:RecentChanges&amp;feed=atom" />
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-0x1500_control_code_arbitrary_code_execution rootpage-0x1500_control_code_arbitrary_code_execution skin-monobook action-view"><div id="globalWrapper"><div id="column-content"><div id="content" class="mw-body" role="main"><a id="top"></a><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">0x1500 control code arbitrary code execution</h1><div id="bodyContent" class="mw-body-content"><div id="siteSub">From Glitch City Wiki</div><div id="contentSub" lang="en" dir="ltr"></div><div id="jump-to-nav"></div><a href="#column-one" class="mw-jump-link">Jump to navigation</a><a href="#searchInput" class="mw-jump-link">Jump to search</a><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div style="border: 1px solid #000000; padding: .5em 1em; color: #000000; background-color: #FFFFFF; margin: 3px 3px 0; text-align: center"><b><a href="Category_Arbitrary_code_execution.html" title="Category:Arbitrary code execution">Arbitrary code execution</a></b> in the Pokémon series<br /><br /> <a class="mw-selflink selflink">0x1500 control code arbitrary code execution</a> (Crystal) | <a href="Cart-swap_arbitrary_code_execution.html" title="Cart-swap arbitrary code execution">Cart-swap arbitrary code execution</a> | <a href="Arbitrary_code_execution.html#Via_custom_map_script_pointer" title="Arbitrary code execution">Generation I custom map script pointer</a> | <a href="Arbitrary_code_execution.html#Via_invalid_meta-map_scripts" title="Arbitrary code execution">Generation I invalid meta-map scripts</a> | <a href="Arbitrary_code_execution.html#Via_items" title="Arbitrary code execution">Generation I item</a> ("8F", "ws m", "-g m", "5かい", "てへ" etc.) | <a href="Arbitrary_code_execution.html#Via_items" title="Arbitrary code execution">Generation I move</a> ("-", "TM42") | <a href="Arbitrary_code_execution.html#Via_text_boxes" title="Arbitrary code execution">Generation I Trainer escape glitch text boxes</a> | <a href="Arbitrary_code_execution.html#Via_bad_clone" title="Arbitrary code execution">Generation II bad clone</a> | <a href="Burned_Tower_Silver_wrong_side_effects.html" class="mw-redirect" title="Burned Tower Silver wrong side effects">Generation II Burned Tower Silver</a> | <a href="Pok%c3%a9mon_Communication_Center_SRAM_glitches.html" title="Pokémon Communication Center SRAM glitches">Japanese Crystal Pokémon Communication Center SRAM glitches</a> | <a href="Coin_Case_glitch.html" class="mw-redirect" title="Coin Case glitch">Coin Case glitch</a> | <a href="Glitch_Pok%c3%a9dex_sorting.html" title="Glitch Pokédex sorting">Generation II glitch Pokédex sortings</a> | <a href="Arbitrary_code_execution.html#Via_Pikachu_off-screen_glitch.29" title="Arbitrary code execution">Pikachu off-screen glitch ACE</a> | <a href="OAM_DMA_hijacking.html" title="OAM DMA hijacking">OAM DMA hijacking</a> | <a href="Arbitrary_code_execution.html#Via_Pikachu_glitch_emote" title="Arbitrary code execution">Pikachu glitch emote</a> | <a href="Arbitrary_code_execution.html#In_Generation_III" title="Arbitrary code execution">Generation III glitch Pokémon summary</a> | <a href="Arbitrary_code_execution.html#In_Generation_III" title="Arbitrary code execution">Generation III glitch move animation</a>) | <a href="Remote_code_execution.html" title="Remote code execution">Remote code execution</a> | <a href="TM/HMs_outside_of_the_TM/HM_pocket.html" class="mw-redirect" title="TM/HMs outside of the TM/HM pocket">TM/HMs outside of the TM/HM pocket</a> | <a href="Arbitrary_code_execution.html#Via_ZZAZZ_Trainer_hex:FC" title="Arbitrary code execution">ZZAZZ glitch Trainer FC</a>
<p><br />
<a href="List_of_arbitrary_code_execution_programs.html" title="List of arbitrary code execution programs">List of arbitrary code execution programs</a>
<br />
</p>
<span style="font-size:11px">(<a href="Template_Arbitrary_code_execution.html" title="Template:Arbitrary code execution">view</a>, <a href="Template_talk_Arbitrary_code_execution.html?title=Template_talk:Arbitrary_code_execution&amp;action=edit&amp;redlink=1" class="new" title="Template talk:Arbitrary code execution (page does not exist)">talk</a>, <a rel="nofollow" class="external text" href="indexbcb0.html?title=Template:Arbitrary_code_execution&amp;action=edit">edit</a>)</span></div>
<table border="2" class="toccolours" style="clear:right; float:right; background: #CCCCCC; width: 250px;" cellspacing="3" cellpadding="3" rules="none">
<tbody><tr>
<td><b>This article is incomplete. Please feel free to add any missing information about the subject. It is missing: Original speedrunning method needed. Cover starting menu ACE research as well..</b>
</td></tr></tbody></table>
<div class="thumb tright"><div class="thumbinner" style="width:162px;"><a href="File_0x1500_Lapras.html" class="image"><img alt="" src="images/6/6d/0x1500_Lapras.png" decoding="async" width="160" height="144" class="thumbimage" /></a> <div class="thumbcaption"><div class="magnify"><a href="File_0x1500_Lapras.html" class="internal" title="Enlarge"></a></div>Traded Lapras method. In this case, the arbitrary code execution is triggered after exiting the inventory with A on Cancel with Antidote x21 at the bottom of the bag, and then viewing Lapras's summary.</div></div></div>
<p><b>0x1500 control code arbitrary code execution</b> is an <a href="Arbitrary_code_execution.html" title="Arbitrary code execution">arbitrary code execution</a> method found in <a href="https://bulbapedia.bulbagarden.net/wiki/Pokémon_Crystal_Version" class="extiw" title="bp:Pokémon Crystal Version">Pokémon Crystal</a>. It does not occur in <a href="https://bulbapedia.bulbagarden.net/wiki/Pokémon_Gold_and_Silver_Versions" class="extiw" title="bp:Pokémon Gold and Silver Versions">Pokémon Gold and Silver</a>.
</p><p>A specific variation of this glitch involving an <a href="Unterminated_name_Pok%c3%a9mon_(Generation_II).html" title="Unterminated name Pokémon (Generation II)">unterminated name glitch Pokémon</a> is also known as <b>unterminated name Pokémon arbitrary code execution</b>.
</p><p>Both of these exploits were discovered by luckytyphlosion. The original method used for speedrunning purposes is not yet covered in this article.
</p><p>This glitch involves the combination of the byte 0x15 ("Mobile" control character) followed by 0x00 in a text string, and will lead to arbitrary code execution at memory address $CD52. Once the code is terminated with a ret, the program counter by default will be at the location following where the 0x1500 sequence was in the RAM.
</p>
<div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Effects_of_the_0x15_control_character"><span class="tocnumber">1</span> <span class="toctext">Effects of the 0x15 control character</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#General_procedure"><span class="tocnumber">2</span> <span class="toctext">General procedure</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Setup_and_bootstrap_methods"><span class="tocnumber">3</span> <span class="toctext">Setup and bootstrap methods</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Unterminated_name_glitch_Pok.C3.A9mon_method_w.2F_traded_Lapras_and_box_names"><span class="tocnumber">3.1</span> <span class="toctext">Unterminated name glitch Pokémon method w/ traded Lapras and box names</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Video"><span class="tocnumber">3.1.1</span> <span class="toctext">Video</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Requirements"><span class="tocnumber">3.1.2</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Steps"><span class="tocnumber">3.1.3</span> <span class="toctext">Steps</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#Stored_unterminated_name_Pok.C3.A9mon.2Fbad_clone_method_w.2F_stored_PC_items"><span class="tocnumber">3.2</span> <span class="toctext">Stored unterminated name Pokémon/bad clone method w/ stored PC items</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Video_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Video</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Requirements_2"><span class="tocnumber">3.2.2</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Steps_2"><span class="tocnumber">3.2.3</span> <span class="toctext">Steps</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Self-contained_setup_and_bootstrap"><span class="tocnumber">3.3</span> <span class="toctext">Self-contained setup and bootstrap</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Technical_details"><span class="tocnumber">4</span> <span class="toctext">Technical details</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Attribution"><span class="tocnumber">5</span> <span class="toctext">Attribution</span></a></li>
</ul>
</div>
<h2><span class="mw-headline" id="Effects_of_the_0x15_control_character">Effects of the 0x15 control character</span></h2>
<p>The 0x15 control character signifies a "mobile script" in Crystal. When the text engine reads the byte 0x15, it uses the following bytes as jump table indices to a list of specific functions ("mobile functions"). The valid jump table indices are 0x01 to 0x0f (i.e. 1 to 15), and an index &gt;= 0x10 would end the mobile script interpretation procedure instead of being used as a jump table index. Notice that some mobile functions may "take parameters" by consuming them from the text stream.
</p><p>However, the byte 0x00 is not excluded by the above check. It would be interpreted as jump table index 256, and the jump target is $CD52, which is a WRAM address used in some mobile functions. Therefore, when the text engine sees the byte combination "0x15 0x00", it will jump there, leading to ACE exploits.
</p>
<h2><span class="mw-headline" id="General_procedure">General procedure</span></h2>
<p>Usually, there are three components to the setup for exploiting this glitch:
</p>
<ul><li>"0x1500" setup: Have a string that, when displayed, cause the text engine read the byte sequence "0x15 0x00". This can be achieved by either putting the sequence in the string itself, or by trying to display an unterminated string, and putting the sequence somewhere after the text buffer.</li>
<li>Bootstrap: Put some assembly instruction at or shortly after memory address $CD52, in order to jump to some more easily manipulated memory area, usually the box names.</li>
<li>Payload: The actual arbitrary code to be executed.</li></ul>
<p>These steps are not necessarily done in the above order. For example, the player may first set up the payload in the form of box names, as that is the most robust part of the setup. Then the player may use some specific movements to set up the BG map buffer for a multi-level bootstrap. Finally, the player may use an incomplete toss to set up 0x1500, and view the name of an <a href="Unterminated_name_Pok%c3%a9mon_(Generation_II).html" title="Unterminated name Pokémon (Generation II)">unterminated name glitch Pokémon</a> to do the exploit.
</p><p>This article will focus on the "0x1500" setup and the bootstrap. For some examples of payloads, see <a href="Crystal_box_name_codes.html" title="Crystal box name codes">Crystal box name codes</a>.
</p>
<h2><span class="mw-headline" id="Setup_and_bootstrap_methods">Setup and bootstrap methods</span></h2>
<h3><span id="Unterminated_name_glitch_Pokémon_method_w/_traded_Lapras_and_box_names"></span><span class="mw-headline" id="Unterminated_name_glitch_Pok.C3.A9mon_method_w.2F_traded_Lapras_and_box_names">Unterminated name glitch Pokémon method w/ traded Lapras and box names</span></h3>
<p>For this method, an <a href="Unterminated_name_glitch_Pok%c3%a9mon.html" class="mw-redirect" title="Unterminated name glitch Pokémon">unterminated name glitch Pokémon</a> is required. A convenient way of getting one is through a box name corruption glitch in <a href="https://bulbapedia.bulbagarden.net/wiki/Pokémon_Red_and_Blue_Versions" class="extiw" title="bp:Pokémon Red and Blue Versions">Pokémon Red, Blue</a>, and <a href="https://bulbapedia.bulbagarden.net/wiki/Pokémon_Yellow_Version" class="extiw" title="bp:Pokémon Yellow Version">Yellow</a>, such as through the <a href="ItemDex/RB_094.html" title="ItemDex/RB:094">9F (0x5E)</a> glitch item in <a href="https://bulbapedia.bulbagarden.net/wiki/Pokémon_Red_and_Blue_Versions" class="extiw" title="bp:Pokémon Red and Blue Versions">Pokémon Red and Blue</a>.
</p>
<h4><span class="mw-headline" id="Video">Video</span></h4>
<table align="center" style="border-radius: 10px; -moz-border-radius: 10px; -webkit-border-radius: 10px; -khtml-border-radius: 10px; -icab-border-radius: 10px; -o-border-radius: 10px; border: 2px solid #828282; background: #cccccc;">
<tbody><tr>
<td width="425px" colspan="2"><center>
<p><iframe width="420" height="238" src="http://www.youtube-nocookie.com/embed/VtRFxxKW7mY" frameborder="0" allowfullscreen=""></iframe>
</p>
</center>
</td></tr>
<tr>
<td width="425px" colspan="2" style="line-height:10px"><center><b><a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=VtRFxxKW7mY">YouTube video by ChickasaurusGL</a></b></center>
</td></tr>
</tbody></table>
<h4><span class="mw-headline" id="Requirements">Requirements</span></h4>
<p>1) A Lapras with Perish Song (level 29 in Generation II), Bide (TM34 in Generation I) and Safeguard (level 50 in Generation II) which will have its name corrupted. The Lapras should be able to gain experience with an Exp. Share or Rare Candies (in this video Rare Candies are used from outside of the items pack, which allows them to be used effectively infinitely).
</p><p>2) The 9F glitch item in Pokémon Red/Blue if you want to corrupt Lapras' name without getting a bad clone in Generation II. When the 9F glitch item is used many times with Lapras in the box, its name will corrupt.
</p><p>You can then save and reset the game to withdraw it and its moves shouldn't be corrupted if you didn't use 9F too much. We can get the 9F glitch item with dry underflow glitch (<a rel="nofollow" class="external free" href="https://www.youtube.com/watch?v=ZyppA">https://www.youtube.com/watch?v=ZyppA</a>...) with the Celadon looping map trick (<a rel="nofollow" class="external free" href="http://glitchcity.info/wiki/Celadon_l">http://glitchcity.info/wiki/Celadon_l</a>...).
</p><p>3) Two Generation II core games; one a that just got the ability to trade (this was a measure due to the glitch not working on a later save file) with Crystal and another (with access to the Time Capsule after meeting Bill in Ecruteak City and waiting a day) to raise Lapras to level 50.
</p><p>4) Specific box names for storage box 1
</p>
<h4><span class="mw-headline" id="Steps">Steps</span></h4>
<p>1) Teach level 28 Lapras on Generation I Bide via TM34; move 2.
</p><p>2) Deposit in the PC, corrupt nickname with 9F. Try about 15 9F uses each iteration.
</p><p>3) Save and reset after nickname is corrupted, view a Pokémon summary that can withdraw unterminated name Pokémon and withdraw the Pokémon.
</p><p>4) Trade to a Generation II game (Time Capsule must be enabled - meet Bill in Ecruteak and wait one day).
</p><p>5) Raise it to level 29 (e.g. with Rare Candy) to learn Perish Song; move 1. Raise it to level 50 to learn Safeguard; move 3.
</p><p>6) Trade to a new Generation II Crystal that just got to the Pokémon Center with Antidote x21 purchased
</p><p>7) Do box name cheats and save every iteration. There are various examples below. Before doing a <a href="Crystal_box_name_codes.html" title="Crystal box name codes">box name cheat</a> (box name cheats can be set via a PC by altering PC names), save and reset the game and then perform the following; In order to perform the box names cheats, have Antidote x21 at the bottom of the inventory, try to toss all x21 (move toss counter down to show all x21) but Cancel with B, scroll down and exit by pressing A on Cancel (not with B), and then view the Lapras summary to execute arbitrary code.
</p>
<h3><span id="Stored_unterminated_name_Pokémon/bad_clone_method_w/_stored_PC_items"></span><span class="mw-headline" id="Stored_unterminated_name_Pok.C3.A9mon.2Fbad_clone_method_w.2F_stored_PC_items">Stored unterminated name Pokémon/bad clone method w/ stored PC items</span></h3>
<h4><span class="mw-headline" id="Video_2">Video</span></h4>
<table align="center" style="border-radius: 10px; -moz-border-radius: 10px; -webkit-border-radius: 10px; -khtml-border-radius: 10px; -icab-border-radius: 10px; -o-border-radius: 10px; border: 2px solid #828282; background: #cccccc;">
<tbody><tr>
<td width="425px" colspan="2"><center>
<p><iframe width="420" height="238" src="http://www.youtube-nocookie.com/embed/YqD68-2aAjg" frameborder="0" allowfullscreen=""></iframe>
</p>
</center>
</td></tr>
<tr>
<td width="425px" colspan="2" style="line-height:10px"><center><b><a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=YqD68-2aAjg">YouTube video by Crystal_</a></b></center>
</td></tr>
</tbody></table>
<h4><span class="mw-headline" id="Requirements_2">Requirements</span></h4>
<p>(From Crystal_'s video)
</p><p>1. Items in the PC item storage ended with a ret command, with register de set to a specific value (e.g. 0134)
</p><p>2. A bad clone in the current PC box
</p><p>3. Max Elixer or TM21 (Frustration) in the bag
</p><p>4. Quagsire in party slot 1, with Return as move 1, with a move with less than 10 characters in it, in slot 4
</p><p>5. Spearow holding TM50 (Nightmare) in party slot 2. TM49 may also work and depends on the number of items in the PC item storage.
</p>
<h4><span class="mw-headline" id="Steps_2">Steps</span></h4>
<p>1. Save and reset the game just outside of a regular Pokémon Center
</p><p>2. Press up on the d-pad only, until the player character is one tile below the Pokémon Center desk
</p><p>3. Move right only, until facing the wall/edge of map
</p><p>4. Move up only until facing the PC. Do not use the PC yet.
</p><p>5. Press Start and open the player's bag
</p><p>6. Have the cursor point to Max Elixer or TM21, then exit the bag without pressing A on the item
</p><p>7. Go to deposit a Pokémon and view your Quagsire's summary.
</p><p>8. Exit and scroll down to Spearow, then exit Deposit
</p><p>9. Choose withdraw and have the cursor on the bad clone/unterminated name Pokémon, which will force its name and the 0x1500 sequence that follows, and cause arbitrary code execution.
</p>
<h3><span class="mw-headline" id="Self-contained_setup_and_bootstrap">Self-contained setup and bootstrap</span></h3>
<p>If the player has the ability to put arbitrary data in a string, then both the setup and the bootstrap can actually both be done from within the string itself:
</p>
<ul><li>Instead of setting up "0x15 0x00" after the string buffer, 0x15 followed by 0x00 in the string itself could be used to trigger this glitch.</li>
<li>By putting carefully constructed byte sequences between 0x15 and 0x00, valid mobile functions can be triggered and modify the value at $CD52.</li></ul>
<p>This principle can be used after the player has already achieved ACE, to make subsequent execution of arbitrary code easier. Alternatively, they might be used to setup ACE by trading with another game, or with a <a href="Game-altering_device.html" class="mw-redirect" title="Game-altering device">game-altering device</a>.
</p><p>The following self-contained setups are designed by pfero:
</p>
<pre>4F 15 08 05 C9 00 [code] 37 C9
</pre>
<p>This works in any unverified string, notably including Pokémon nickname and mail messages. This means that it can be transferred from any Generation I game (with just enough space to jump to a more convenient location) or Generation II game (with more space to possibly write a "built-in" payload).
</p>
<pre>15 0A C0 00 [code] E1 C9
15 0B C0 00 [code] E1 C9
</pre>
<p>The first setup is specifically designed for mail messages, the second one might be useful elsewhere. The first one depends on the value of hl (the location where the current character in the string is being printed to) translating to valid instructions to slide for two bytes; the second one depends on hl+3 in the same way. The first setup might not work on Japanese versions, due to the behavior of mobile function 0x0A being different.
</p>
<h2><span class="mw-headline" id="Technical_details">Technical details</span></h2>
<p>Luckytyphlosion offers <a rel="nofollow" class="external text" href="https://forums.glitchcity.info/index.php?topic=7706.msg203310#msg203310">the following explanation</a> on the forums:
</p><p>"Basically, it's the cause of poor error checking by GameFreak. When the game has to print the Fake Bad Clone's name through the PlaceString function, it encounters 0x00 characters which aren't supposed to be printed.
</p><p>In Gold/Silver, encountering a 0x00 character would cause the game to stop processing the string (and also terminate a call from the text processing engine, although that's irrelevant in this case). However, in Crystal, for whatever reason GameFreak replaced this error checking so encountering a 0x00 character would print a&#160;? instead. This can lead to PlaceString writing past the tilemap in WRAM and into other RAM (as seen in Crystal_'s Bad Clone/Kingdra video).
</p><p>This new error checking has another consequence; being able to read invalid characters. Normally this would not be too destructive; the only thing you could do at best (worst?) is overflowing text into other portions of RAM, as seen above. However, due to another instance of bad error checking, the &lt;DAY&gt; control code (0x15) can jump to a fairly exploitable portion of RAM, 0xcd52.
</p><p>The code for control code 0x15 jumps to a mobile function, Function17f036, which then calls Function17f036 leading to a jumptable, which reads the next byte from the source as the jumptable index. While there's error checking implemented, GameFreak missed one invalid index, 0x00. The maximum index check checks if the index is greater than the upper bound, but then decrements the a register after the error check. This can allow a 0x00 index to pass through the error check, but then underflow to 0xFF, thereby reading an invalid address from ROM, which conveniently points to WRAM, and a fairly manipulable portion. This is why you need the byte combination 0x15 0x00 to jump to 0xcd52.
</p><p>From there, you can do whatever setup you want to achieve ACE. Conveniently, Gamefreak pushed the source address onto the stack before jumping to the specified address, so the return address will point to whatever was after the 0x15 0x00. In the Crystal Any% speedrun case, this is an immense help as the memory after is a temporary buffer for storing a Pokemon struct (which stores the Pokémon with the corrupted nickname), allowing us to use the moves and trainer ID as a bootstrap to reach box names.
</p><p>It might be possible to find other locations for a bootstrap. The address where the game jumps is similar to the address where Coin Case jumps in Gold/Silver, so you could potentially manipulate the BG Map buffers to jump to a more suitable place. (The jump to the middle of party data would not work, as the address of party data had shifted in Crystal).
</p><p>Interestingly, I found this ACE exploit a while ago when attempting to do regular cloning, but I dismissed it as the result of a crash. (When I was doing some testing regarding cloning, I encountered this glitch again and actually decided to look into it)."
</p>
<h2><span class="mw-headline" id="Attribution">Attribution</span></h2>
<ul><li>Much of the text in this article (specifically for the Lapras method) is courtesy of ChickasaurusGL's video description, with permission.</li>
<li>Luckytyplosion offered <a rel="nofollow" class="external text" href="https://forums.glitchcity.info/index.php?topic=7706.msg203310#msg203310">an in-depth explanation</a> on the forums.</li>
<li>Pfero introduced the idea of a self-contained setup, and did some preliminary research on the effects of valid mobile functions.</li></ul>



</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="indexc180.html?title=0x1500_control_code_arbitrary_code_execution&amp;oldid=5374">https://glitchcity.wiki/index.php?title=0x1500_control_code_arbitrary_code_execution&amp;oldid=5374</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Incomplete.html" title="Category:Incomplete">Incomplete</a></li><li><a href="Category_Pages_with_an_accompanying_YouTube_video.html" title="Category:Pages with an accompanying YouTube video">Pages with an accompanying YouTube video</a></li><li><a href="Category_Arbitrary_code_execution.html" title="Category:Arbitrary code execution">Arbitrary code execution</a></li></ul></div></div><div class="visualClear"></div></div></div><div class="visualClear"></div></div><div id="column-one" lang="en" dir="ltr"><h2>Navigation menu</h2><div role="navigation" class="portlet" id="p-cactions" aria-labelledby="p-cactions-label"><h3 id="p-cactions-label" lang="en" dir="ltr">Page actions</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="ca-nstab-main" class="selected"><a href="0x1500_control_code_arbitrary_code_execution.html" title="View the content page [c]" accesskey="c">Page</a></li><li id="ca-talk" class="new"><a href="Talk_0x1500_control_code_arbitrary_code_execution.html?title=Talk:0x1500_control_code_arbitrary_code_execution&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></li><li id="ca-viewsource"><a href="index94a0.html?title=0x1500_control_code_arbitrary_code_execution&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="index6424.html?title=0x1500_control_code_arbitrary_code_execution&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></div></div><div role="navigation" class="portlet" id="p-cactions-mobile" aria-labelledby="p-cactions-mobile-label"><h3 id="p-cactions-mobile-label" lang="en" dir="ltr">Page actions</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="ca-nstab-main-mobile" class="selected"><a href="0x1500_control_code_arbitrary_code_execution.html" title="Page">Page</a></li><li id="ca-talk-mobile" class="new"><a href="Talk_0x1500_control_code_arbitrary_code_execution.html?title=Talk:0x1500_control_code_arbitrary_code_execution&amp;action=edit&amp;redlink=1" rel="discussion" title=" (page does not exist)">Discussion</a></li><li id="ca-more"><a href="#p-cactions">More</a></li><li id="ca-tools"><a href="#p-tb" title="Tools">Tools</a></li></ul></div></div><div role="navigation" class="portlet" id="p-personal" aria-labelledby="p-personal-label"><h3 id="p-personal-label" lang="en" dir="ltr">Personal tools</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="pt-createaccount"><a href="index6d0d.html?title=Special:CreateAccount&amp;returnto=0x1500+control+code+arbitrary+code+execution&amp;returntoquery=printable%3Dyes" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="index695e.html?title=Special:UserLogin&amp;returnto=0x1500+control+code+arbitrary+code+execution&amp;returntoquery=printable%3Dyes" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li></ul></div></div><div class="portlet" id="p-logo" role="banner"><a href="Main_Page.html" class="mw-wiki-logo" title="Visit the main page"></a></div><div id="sidebar"><div role="navigation" class="portlet generated-sidebar" id="p-Main_Menu" aria-labelledby="p-Main_Menu-label"><h3 id="p-Main_Menu-label" lang="en" dir="ltr">Main Menu</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Main-page"><a href="Main_Page.html">Main page</a></li><li id="n-New-pages"><a href="Special_NewPages.html">New pages</a></li><li id="n-Recent-changes"><a href="Special_RecentChanges.html">Recent changes</a></li><li id="n-Random-page"><a href="Sky_Drop_glitch_(disambiguation).html">Random page</a></li><li id="n-Help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents">Help</a></li></ul></div></div><div role="navigation" class="portlet generated-sidebar" id="p-Glitches" aria-labelledby="p-Glitches-label"><h3 id="p-Glitches-label" lang="en" dir="ltr">Glitches</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Arbitrary-code-execution"><a href="Arbitrary_code_execution.html">Arbitrary code execution</a></li><li id="n-Pok.C3.A9mon-cloning"><a href="Pok%c3%a9mon_cloning.html">Pokémon cloning</a></li><li id="n-Pomeg-glitch-and-Glitzer-Popping"><a href="Pomeg_data_corruption_glitch.html">Pomeg glitch and Glitzer Popping</a></li><li id="n-Tweaking-and-voiding"><a href="Tweaking.html">Tweaking and voiding</a></li><li id="n-Glitches-by-generation"><a href="Category_Generational_Glitches.html">Glitches by generation</a></li><li id="n-Other-glitch-categories"><a href="Category_Glitches_by_category.html">Other glitch categories</a></li></ul></div></div><div role="navigation" class="portlet generated-sidebar" id="p-References.2FResources" aria-labelledby="p-References.2FResources-label"><h3 id="p-References.2FResources-label" lang="en" dir="ltr">References/Resources</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Databases"><a href="Glitch_City_Laboratories_Databases.html">Databases</a></li><li id="n-Disassembly-projects"><a href="List_of_Pok%c3%a9mon_disassembly_projects.html">Disassembly projects</a></li><li id="n-The-Big-HEX-List"><a href="The_Big_HEX_List.html">The Big HEX List</a></li><li id="n-Interactive-tools"><a href="Category_Interactive_tools.html">Interactive tools</a></li><li id="n-Reference-documents"><a href="Category_Reference_documents.html">Reference documents</a></li><li id="n-Terminology"><a href="Category_Terminology.html">Terminology</a></li></ul></div></div><div role="navigation" class="portlet generated-sidebar" id="p-Speedrun_Routes_any.25" aria-labelledby="p-Speedrun_Routes_any.25-label"><h3 id="p-Speedrun_Routes_any.25-label" lang="en" dir="ltr">Speedrun Routes any%</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-Pok.C3.A9mon-Crystal"><a href="Pok%c3%a9mon_Crystal_any%25_speedrun_route.html">Pokémon Crystal</a></li><li id="n-Pok.C3.A9mon-Blue"><a href="Pok%c3%a9mon_Blue_any%25_No_Save_Corruption_speedrun_route.html">Pokémon Blue</a></li></ul></div></div><div role="navigation" class="portlet generated-sidebar" id="p-External_Links" aria-labelledby="p-External_Links-label"><h3 id="p-External_Links-label" lang="en" dir="ltr">External Links</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="n-GCRI-Discord"><a href="https://discord.gg/EA7jxJ6" rel="nofollow">GCRI Discord</a></li></ul></div></div><div role="navigation" class="portlet" id="p-tb" aria-labelledby="p-tb-label"><h3 id="p-tb-label" lang="en" dir="ltr">Tools</h3><div class="pBody"><ul lang="en" dir="ltr"><li id="t-whatlinkshere"><a href="Special_WhatLinksHere/0x1500_control_code_arbitrary_code_execution.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/0x1500_control_code_arbitrary_code_execution.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="indexc180.html?title=0x1500_control_code_arbitrary_code_execution&amp;oldid=5374" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index34ef.html?title=0x1500_control_code_arbitrary_code_execution&amp;action=info" title="More information about this page">Page information</a></li></ul></div></div><div role="search" class="portlet" id="p-search"><h3 id="p-search-label" lang="en" dir="ltr"><label for="searchInput">Search</label></h3><div class="pBody" id="searchBody"><form action="https://glitchcity.wiki/index.php" id="searchform"><input type="hidden" value="Special:Search" name="title" /><input type="search" name="search" placeholder="Search Glitch City Wiki" title="Search Glitch City Wiki [f]" accesskey="f" id="searchInput" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton" />  <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" /></form></div></div></div><a href="#sidebar" title="navigation" class="menu-toggle" id="sidebar-toggle"></a><a href="#p-personal" title="user tools" class="menu-toggle" id="p-personal-toggle"></a><a href="#globalWrapper" title="back to top" class="menu-toggle" id="globalWrapper-toggle"></a></div><div class="visualClear"></div><div id="footer" role="contentinfo" lang="en" dir="ltr"><div id="f-poweredbyico" class="footer-icons"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a></div><ul id="f-list"><li id="lastmod"> This page was last edited on 26 November 2019, at 11:07.</li><li id="privacy"><a href="Glitch_City_Wiki_Privacy_policy.html" title="Glitch City Wiki:Privacy policy">Privacy policy</a></li><li id="about"><a href="Glitch_City_Wiki_About.html" class="mw-redirect" title="Glitch City Wiki:About">About Glitch City Wiki</a></li><li id="disclaimer"><a href="Glitch_City_Wiki_General_disclaimer.html" title="Glitch City Wiki:General disclaimer">Disclaimers</a></li></ul></div></div>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.031","walltime":"0.033","ppvisitednodes":{"value":116,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1000000},"postexpandincludesize":{"value":3870,"limit":2097152},"templateargumentsize":{"value":144,"limit":2097152},"expansiondepth":{"value":4,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":250,"limit":5000000},"timingprofile":["100.00%    7.167      1 -total"," 19.58%    1.403      2 Template:YouTube"," 19.21%    1.377      1 Template:Arbitrary_code_execution"," 14.13%    1.013      1 Template:Crystal"," 11.99%    0.859      1 Template:Incomplete","  8.40%    0.602      1 Template:RBY","  8.13%    0.583      1 Template:RB","  7.58%    0.543      1 Template:GS"]},"cachereport":{"timestamp":"20201016203208","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":45});});</script><div>This is a full mirror from glitchcity.wiki dated 16/10/2020, for preservation purposes. All rights belong to the original copyright owners. This is a mirror of content freely available on the public domain.</div></body>
<!-- Mirrored from glitchcity.wiki/index.php?title=0x1500_control_code_arbitrary_code_execution&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 Oct 2020 08:04:04 GMT -->
</html>